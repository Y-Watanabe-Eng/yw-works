<!DOCTYPE html>
<html lang="ja">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Y.Watanabe｜Python</title>
    <meta name="description" content="ポートフォリオサイト">
    <meta name="keywords" content="VBA,Python,プログラマ,エンジニア,コード">
    <link rel="shortcut icon" href="/yw-works/ico/favicon.ico">
    <link rel="apple-touch-icon" href="/yw-works/ico/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/yw-works/ico/android-chrome-192x192.png">
    <link rel="stylesheet" href="/yw-works/prism.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/yw-works/css/style.css">
    <script src="/Works/js/prism.js" defer></script>

</head>


<body style="background-color:#000000;">
<div class="container">
<div class="jumbotron"  style="background:url(/yw-works/img/top.jpg); background-size:cover; width: 100%;">
<header>
  <br/>
            
  <span class="display-2 px-4"><a href="/yw-works" class="text-decoration-none text-light">Y.Watanabe</a></span>
  <small class="text-light">ポートフォリオ</small>
  <br/>

<nav class="px-5 pt-5 pb-2" style="--bs-breadcrumb-divider: '>';" aria-label="パンくずリスト">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a class="text-decoration-none text-light" href="/yw-works">TOP</a></li>
    <li class="breadcrumb-item active" aria-current="page">Python</li>
  </ol>
</nav>

</header>
</div>
</div>
        
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y24BD0K2VY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y24BD0K2VY');
</script>
    
<div class="container">    

<h2 class="text-center my-5 text-success">WEBアプリ</h2>

<div class="row justify-content-center">
<div class="col col-10">

  <p class="text-light">アプリ名</p>
  <li class="text-light">MiniMemo</li>
  <br/>
  <p class="text-light">実装環境</p>
  <li class="text-light">開発環境:VSCode:1.78.2</li>
  <li class="text-light">Python:3.11.1</li>
  <li class="text-light">フレームワーク:Django:4.2.1</li>
  <li class="text-light">仮想環境構築:Docker:23.0.5</li>
  <li class="text-light">VM構築:AWS EC2</li>
  <li class="text-light">ネットワーク設定:AWS VPC</li>
  <li class="text-light">サーバOS:Ubuntu:22.04</li>
  <li class="text-light">DB:PostgreSQL:15.2(ORMによる操作)</li>
  <li class="text-light">APサーバ:Gunicorn:20.1.0</li>
  <li class="text-light">WEBサーバ:Nginx:1.21</li>

  <br/>

<div class="d-flex  justify-content-center mb-3">
  <button type="button" class="btn btn-outline-success btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModal">MiniMemo</button>
</div>

</div>
</div>

<br/>

<h2 class="text-center my-5 text-success">WEBスクレイピング</h2>

<div class="row justify-content-center">
<div class="col col-10">
  <p class="text-light">機能/抽出データ</p>
  <li class="text-light">今季放映開始のアニメタイトルと<br/>
                        その詳細ページを取得し、CSV出力。</li>
  <br/>
  <p class="text-light">動作環境</p>
  <li class="text-light">Python:3.11.1</li>
  <li class="text-light">BeautifulSoup:4.12.2</li>
  <li class="text-light">request:2.31.0</li>
  <li class="text-light">Excel:2016</li>  

<br/>

<div class="d-flex justify-content-center mb-3">
  <button type="button" class="btn btn-outline-success btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModal1">ソースコード</button>
</div>

</div>
</div>
  <br/>


<!-- モーダルの設定1 -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel1">WEBスクレイピング</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="EXIT"></button>
      </div>
      <div class="modal-body">


<pre>
  <code class="language-Python">
  import requests
  from bs4 import BeautifulSoup
  import csv
  
  HEADER = ['タイトル', 'URL']
  
  #スクレイピング対象のWEBサイトを指定
  res = requests.get('https://anime.eiga.com/program/')
  
  #指定したサイトのHTMLコードを取得
  soup = BeautifulSoup(res.text, 'html.parser')
  
  #検索範囲を指定
  Container = soup.find('div', class_='animeSeasonContainer')
  
  #pタグのseasonAnimeTtlクラスで囲まれた部位を検索
  class_ttl = Container.find_all('p', class_='seasonAnimeTtl')
  
  #CSVファイルの準備
  with open('now_anime.csv', 'w', encoding = 'utf-8') as f:
      writer = csv.writer(f, lineterminator = '\n')
      writer.writerow(HEADER)
      
      for anime in class_ttl:
          #タイトルテキストを取得
          ttl = anime.find('a').text
          #作品URLを取得
          url = anime.find('a').get('href')
          #URLをフルパスに変換
          full_url = 'https://anime.eiga.com' + url
  
          #CSVに書き出し
          row = [ttl, full_url]
          writer.writerow(row)
          
          #デバッグ用
          print('*************************************************************************************')
          print(ttl)
          print(full_url)
          print('')
  </code>
</pre>


      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<h2 class="text-center my-5 text-success">Excel⇒画像変換</h2>

<div class="row justify-content-center">
<div class="col col-10">

  <p class="text-light">開発環境</p>
  <li class="text-light">エディター:VSCode:1.78.2</li>
  <li class="text-light">Python:3.11.1</li>
  <li class="text-light">Pillow:9.5.0</li>
  <li class="text-light">PyAutoGUI:0.9.54</li>
  <li class="text-light">openpyxl:3.1.2</li>
  <br/>

  <p class="text-light">動作環境</p>
  <li class="text-light">OS:Windows11</li>
  <li class="text-light">Excel:2016</li>
  <li class="text-light">ペイント:11.2302.18.0</li>
  <br/>

<div class="d-flex justify-content-center mb-3">
  <button type="button" class="btn btn-outline-success btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModal2">ソースコード</button>
</div>

</div>
</div>
<br/>



<!-- モーダルの設定2 -->
<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel2">Excel⇒画像変換</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="EXIT"></button>
      </div>
      <div class="modal-body">


<pre>
  <code class="language-Python">
  import sys
  import os
  import tkinter
  import tkinter.messagebox
  import win32com.client as win32
  import subprocess
  from time import sleep
  import pyautogui
  from PIL import ImageGrab
  
  
  #複数のファイルを読み込んだ場合にエラーを返す
  if len(sys.argv) != 2:
      tkinter.Tk().withdraw()
      tkinter.messagebox.showwarning(title='エラー', message='単一のファイルで実行してください。')
  
  else:
      #ドラッグしたブックのパスを取得
      filepath = sys.argv[1]
  
      #ファイル名と拡張子を取得
      filename = os.path.splitext(os.path.basename(filepath))[0]
      ext = os.path.splitext(filepath)[1]
  
      #拡張子が.xlsx以外はエラーメッセージ表示
      if '.xlsx' != ext:
          tkinter.Tk().withdraw()
          tkinter.messagebox.showwarning(title='エラー', message='このアプリは拡張子が".xlsx"のファイルのみをサポートしています。')
  
      else:
          #Excelに接続
          xl = win32.Dispatch("Excel.Application")
  
          #ブックを開く
          wb = xl.Workbooks.Open(filepath)
  
          #シートを指定
          ws = wb.Worksheets(1)
  
          #セル範囲を指定
          range = ws.UsedRange
  
          #指定した範囲をクリップボードにコピー
          range.Copy()
  
          #ペイントを起動
          subprocess.Popen('mspaint')
  
          #起動待機
          sleep(1)
  
          #ペースト⇒コピーで画像取得
          pyautogui.hotkey('ctrl', 'v')
          pyautogui.hotkey('ctrl', 'x')
  
          #ペイントを閉じる
          pyautogui.hotkey('alt', 'f4')
          pyautogui.hotkey('n')
  
          #Excelを閉じる
          wb.close
  
          #クリップボードの内容を取得
          img = ImageGrab.grabclipboard()
  
          #Excelコピー時に入った左端と上端の1pxの線をトリミング
          img = img.crop((1, 1, img.size[0], img.size[1]))
  
          #保存フォルダを作成
          if not os.path.exists('img'):
              os.makedirs('img')
  
          #画像の保存先を指定
          savepath = './img/' + filename + '.png'
  
          #画像を保存
          img.save(savepath)
  </code>
  </pre>
  
  <pre>
  <code class="language-Python">
  #exe化
  pyinstaller Xlsximg.py --onefile --noconsole --icon=Xlsximg.ico
  </code>
</pre>

      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



<h2 class="text-center my-5 text-success">一斉起動</h2>

<div class="row justify-content-center">
<div class="col col-10">

  <p class="text-light">開発環境</p>
  <li class="text-light">エディター:VSCode:1.78.2</li>
  <li class="text-light">Python:3.11.1</li>
  <li class="text-light">PyAutoGUI:0.9.54</li>
  <br/>

  <p class="text-light">動作環境</p>
  <li class="text-light">OS:Windows11</li>
  <br/>

<div class="d-flex justify-content-center mb-3">
  <button type="button" class="btn btn-outline-success btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModal3">ソースコード</button>
</div>



<!-- モーダルの設定3 -->
<div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel3">一斉起動</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="EXIT"></button>
      </div>
      <div class="modal-body">

<pre>
  <code class="language-Python">
  import os
  import winshell
  import subprocess
  from time import sleep
  
  #フォルダ指定
  folder_path = './Start'
  
  #相対パスを絶対パスに変換
  abs_folder_path = os.path.abspath(folder_path)
  
  #フォルダの有無をチェック
  if not os.path.exists(folder_path):
      #フォルダがない場合は作成
      os.makedirs(folder_path)
      #併せてサンプルテキストを作成
      text = open('./Start/sample.txt','w')
      #テキスト編集
      text.write('ご利用ありがとうございます。\
          \nStartフォルダを作成しましたので、\
          \n起動したいファイル、ショートカット等を格納し、\
          \n再度、Start.exeを実行してください。')text.close()
      #作成したフォルダを開く
      subprocess.Popen(['explorer', abs_folder_path], shell=True)
      #起動待ち
      sleep(1)
  
  #フォルダ内のファイルを取得
  files = [f for f in os.listdir(abs_folder_path)]
  
  #順番にファイルを開く
  for file in files:
      file_path = os.path.join(abs_folder_path, file)
      shortcut = winshell.shortcut(file_path)
      shortcut_path = shortcut.path
      os.startfile(shortcut_path)
  </code>
  </pre>
  
  <br/>
  
  <pre>
  <code class="language-Python">
  #exe化
  pyinstaller Start.py --onefile --noconsole --icon=Start.ico
  </code>
 </pre>


      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



</div>
</div>
<br/>

</div>
</div>
<br/>

<footer class="border-top border-success">
<p class="small text-center my-4 text-light">Copyright&copy; Y.Watanabe All Rights Reserved.</p>
</footer>
    
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</html>
